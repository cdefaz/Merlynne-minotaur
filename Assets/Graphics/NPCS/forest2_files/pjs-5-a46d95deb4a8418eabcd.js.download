webpackJsonp([5,22],{"2FON":function(e,t){},"8N7E":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("d6ZO"),r=n.n(o),a=n("W/Cr"),i=n("Kqaz"),c=n("mu3h"),l=n("gEaE"),s=function e(t){var n=t.handlePinEditButtonClick;return o.createElement(l.n,{accessibilityLabel:a.a._("Edit","edit button on pin"),bgColor:"white",icon:"edit",iconColor:"darkGray",onClick:function e(t){var o=t.event;n(o)}})};t.default=Object(i.a)(Object(c.a)(s))},GDBS:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=n("d6ZO"),c=n.n(i),l=n("RklN"),s=n.n(l),d=n("gEaE"),u=function(e){function t(){var n,a,i;o(this,t);for(var c=arguments.length,s=Array(c),d=0;d<c;d++)s[d]=arguments[d];return n=a=r(this,e.call.apply(e,[this].concat(s))),a.setSearchFieldRef=function(e){a.searchField||(a.searchField=e)},a.setFocus=function(){if(a.searchField){var e=Object(l.findDOMNode)(a.searchField);if(e instanceof HTMLElement){var t=e.querySelector("input");t instanceof HTMLInputElement&&t.focus()}}},i=n,r(a,i)}return a(t,e),t.prototype.componentDidMount=function e(){this.props.focused&&window.requestAnimationFrame(this.setFocus)},t.prototype.componentDidUpdate=function e(t){!t.focused&&this.props.focused&&this.setFocus()},t.prototype.render=function e(){var t=this.props,n=t.accessibilityLabel,o=t.id,r=t.onBlur,a=t.onChange,i=t.onFocus,l=t.placeholder,s=t.value;return c.a.createElement(d.B,{accessibilityLabel:n,id:o,onBlur:r,onChange:a,onFocus:i,placeholder:l,ref:this.setSearchFieldRef,value:s})},t}(i.Component);t.a=u},q6Rf:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function y(e){var t=e.pinId;return(0,e.children)(e.suggestedBoardsResource)}function v(e){return{type:"PIN_BETTER_SAVE",payload:e}}function E(e){return{type:"PIN_BETTER_SELECT_BOARD_OR_SECTION",payload:e}}function w(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function I(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function C(e){var t=e.initialSelection,n=w(e,["initialSelection"]);return t?O.createElement(Ee,Object.assign({},n,{initialSelection:t,unselectedText:t.title})):O.createElement(be,{pinId:n.pin.id},function(e){var t=e.data&&e.data[0];return O.createElement(Ee,Object.assign({},n,{initialSelection:t&&{boardId:t.id,title:t.name,url:t.url}||void 0,unselectedText:e.isFetching?"...":M.a._("Select","BetterSave label to pick a board from the list")}))})}Object.defineProperty(t,"__esModule",{value:!0});var O=n("d6ZO"),B=n.n(O),T=n("DUIN"),P=n("2FON"),R=n.n(P),k=n("iSgY"),j=n("gEaE"),x=function e(t){var n=t.showCollaborativeIcon,o=t.showPrivateIcon,r=t.showSectionsIcon;return n||o||r?B.a.createElement(j.b,{display:"flex",direction:"row",paddingX:2},o&&B.a.createElement(k.a,{type:"secret"}),n&&B.a.createElement(k.a,{type:"group"}),r&&B.a.createElement(k.a,{type:"sectionsInline"})):null},L=n("BAXv"),M=n("W/Cr"),F=function(e){function t(){var n,a,i;o(this,t);for(var c=arguments.length,l=Array(c),s=0;s<c;s++)l[s]=arguments[s];return n=a=r(this,e.call.apply(e,[this].concat(l))),a.state={hovered:!1},a.handleMouseEnter=function(){a.setState({hovered:!0})},a.handleMouseLeave=function(){a.setState({hovered:!1})},i=n,r(a,i)}return a(t,e),t.prototype.render=function e(){var t=this.state.hovered,n=this.props,o=n.board,r=n.onClick,a=n.shouldOpenSections,i=!!o.section_count&&o.section_count>0,c=o.privacy===L.a.BoardPrivacy.SECRET;return B.a.createElement(j.N,{onTouch:function e(){r(o)},onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},B.a.createElement(j.b,{color:t?"lightGray":"white",display:"flex",alignItems:"center","data-test-id":"boardRow"},B.a.createElement(j.b,{flex:"none",marginBottom:1,marginLeft:2,marginRight:2,marginTop:1,overflow:"hidden",width:24,height:24,dangerouslySetInlineStyle:{__style:{borderRadius:4}}},o.image_cover_url&&a?B.a.createElement(j.o,{src:o.image_cover_url,alt:"",naturalHeight:1,naturalWidth:1,fit:"cover"}):B.a.createElement(j.b,{color:a?"lightGray":"transparent",width:"100%",height:"100%"})),B.a.createElement(j.b,{flex:"grow",paddingY:1,overflow:"hidden"},B.a.createElement(j.I,{bold:a,truncate:!0},o.name)),t&&(0===o.section_count||!a)&&B.a.createElement(j.b,{color:"red",flex:"none",height:32,paddingX:3,display:"flex",alignItems:"center"},B.a.createElement(j.I,{color:"white",bold:!0},M.a._("Save","Save label on hover - Better save"))),o&&B.a.createElement(x,{showCollaborativeIcon:!!o.is_collaborative,showPrivateIcon:c,showSectionsIcon:i&&a})))},t}(O.Component);F.defaultProps={shouldOpenSections:!0};var D=F,N=function(e){function t(){var n,o,r;i(this,t);for(var a=arguments.length,l=Array(a),s=0;s<a;s++)l[s]=arguments[s];return n=o=c(this,e.call.apply(e,[this].concat(l))),o.state={hovered:!1},o.handleMouseEnter=function(){o.setState({hovered:!0})},o.handleMouseLeave=function(){o.setState({hovered:!1})},r=n,c(o,r)}return l(t,e),t.prototype.render=function e(){var t=this.state.hovered,n=this.props,o=n.board,r=n.section,a=n.onClick;return B.a.createElement(j.N,{onTouch:function e(){return a(r,o)},onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},B.a.createElement(j.b,{color:t?"lightGray":"white",display:"flex",alignItems:"center"},B.a.createElement(j.b,{color:"transparent",flex:"none",marginBottom:1,marginLeft:2,marginRight:2,marginTop:1,overflow:"hidden",width:24,height:24}),B.a.createElement(j.b,{flex:"grow",paddingY:1},B.a.createElement(j.I,{truncate:!0},r.title)),t&&B.a.createElement(j.b,{color:"red",flex:"none",height:32,paddingX:3,display:"flex",alignItems:"center"},B.a.createElement(j.I,{color:"white",bold:!0},M.a._("Save","Save label on hover - Better save")))))},t}(O.Component),A=n("JyNp"),W=function e(t){var n=t.board,o=t.sectionsResource,r=t.onClick,a=o&&o.data||[];return B.a.createElement(j.b,null,!o.isLoaded&&B.a.createElement(j.b,{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",minHeight:200},B.a.createElement(j.E,{accessibilityLabel:M.a._("loading board picker","accessibility text for loading spinner"),show:!0})),o.isLoaded&&B.a.createElement(j.b,null,a.map(function(e){return B.a.createElement(N,{board:n,key:e.id,section:e,onClick:r})})))},H=Object(A.c)({name:"BoardSectionsRepinResource",key:"sectionsResource",options:function e(t){return{board_id:t.board.id}}},{allowStale:!1})(W),G=function(e){function t(){var n,o,r;s(this,t);for(var a=arguments.length,i=Array(a),c=0;c<a;c++)i[c]=arguments[c];return n=o=d(this,e.call.apply(e,[this].concat(i))),o.state={hovered:!1},o.handleMouseEnter=function(){o.setState({hovered:!0})},o.handleMouseLeave=function(){o.setState({hovered:!1})},r=n,d(o,r)}return u(t,e),t.prototype.render=function e(){var t=this.state.hovered,n=this.props,o=n.onClick,r=n.title;return B.a.createElement(j.N,{onTouch:function e(){o({title:r})},onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},B.a.createElement(j.b,{color:t?"lightGray":"white",display:"flex",alignItems:"center"},B.a.createElement(j.b,{flex:"none",marginBottom:1,marginLeft:2,marginRight:2,marginTop:1,overflow:"hidden",width:24,height:24,dangerouslySetInlineStyle:{__style:{borderRadius:4}}},B.a.createElement(j.b,{color:"lightGray",width:"100%",height:"100%"})),B.a.createElement(j.b,{flex:"grow",paddingY:1},B.a.createElement(j.I,{bold:!0,truncate:!0},r))))},t}(O.Component),q=function e(t){var n=t.suggestionsResource,o=t.onClick,r=n&&n.data||[];return B.a.createElement(j.b,null,!n.isLoaded&&B.a.createElement(j.b,{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",minHeight:200},B.a.createElement(j.E,{accessibilityLabel:M.a._("loading board suggestions","accessibility text for loading spinner"),show:!0})),n.isLoaded&&B.a.createElement(j.b,null,r.map(function(e,t){return B.a.createElement(G,{key:t,title:e.title,onClick:o})})))},Q=Object(A.c)({name:"BoardTitleSuggestionsResource",key:"suggestionsResource",options:function e(t){return{pin_id:t.pinId}}},{allowStale:!1})(q),U=function(e){function t(){var n,o,r;p(this,t);for(var a=arguments.length,i=Array(a),c=0;c<a;c++)i[c]=arguments[c];return n=o=h(this,e.call.apply(e,[this].concat(i))),o.state={hovering:!1},o.handleMouseEnter=function(){o.setState({hovering:!0})},o.handleMouseLeave=function(){o.setState({hovering:!1})},r=n,h(o,r)}return f(t,e),t.prototype.render=function e(){var t=this.props.onClick,n=this.state.hovering;return O.createElement(j.N,{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onTouch:t,shape:"rounded"},O.createElement(j.b,{display:"flex",alignItems:"center",color:n?"lightGray":"white",padding:2,width:"100%"},O.createElement(j.b,{marginRight:2},O.createElement(j.m,{accessibilityLabel:"",size:"24",icon:"add-circle",color:"red"})),O.createElement(j.I,{truncate:!0,align:"center",bold:!0},M.a._("Create board"))))},t}(O.Component),X=n("GDBS"),z=n("+kCg"),Y=n("4Gri"),Z=n("MQ2h"),J=n.n(Z),K=n("n9Oa"),V=n("Qqx1"),$=n("tWOI"),ee=function(e){function t(){var n,o,r;b(this,t);for(var a=arguments.length,i=Array(a),c=0;c<a;c++)i[c]=arguments[c];return n=o=m(this,e.call.apply(e,[this].concat(i))),o.state={selectedBoardId:"",selectedBoardCategory:"",searchQuery:""},o.getItems=function(){var e=o.props.boardResource.data,t=e.all_boards,n=e.boards_shortlist,r=t.map(function(e){return o.mapBoards(e,"allBoards")}),a=n.map(function(e){return o.mapBoards(e,"shortlist")}),i=o.state.searchQuery;return i.length>=V.a?[].concat(Object(K.a)(r,i)):[].concat(r.length>3&&a&&a.length?[{type:"header",title:M.a._("Top board suggestions","Header for top suggesions in board picker")}].concat(a):[],[{type:"header",title:M.a._("All boards","Header for all boards in board picker")}].concat(r),r.length<=3?[{type:"header",title:M.a._("Suggested board names","Header for suggested boards in board picker")}]:[])},o.mapBoards=function(e,t){var n=o.state,r=n.selectedBoardId,a=n.selectedBoardCategory,i=e.id===r&&t===a;return Object.assign({},e,{category:t,isOpen:i})},o.handleSectionClick=function(e,t){(0,o.props.onItemChosen)({boardId:t.id,url:t.url,sectionId:e.id,title:e.title||""})},o.handleBoardWithSectionsClick=function(e){var t=o.state,n=t.selectedBoardId,r=t.selectedBoardCategory,a=n===e.id&&r===e.category;o.setState({selectedBoardId:a?"":e.id,selectedBoardCategory:a?"":e.category})},o.handleBoardClick=function(e){var t=e.board,n=e.toggleSections,r=o.props.onItemChosen;n?o.handleBoardWithSectionsClick({id:t.id,category:t.category}):r({boardId:t.id,url:t.url,title:t.name||""})},o.handleSearchQueryUpdate=function(e){o.setState(function(t){return Object.assign({},t,{searchQuery:e})})},r=n,m(o,r)}return g(t,e),t.prototype.componentDidUpdate=function e(t){!t.boardResource.isLoaded&&this.props.boardResource.isLoaded&&this.setPWTLoadingEnd()},t.prototype.setPWTLoadingEnd=function e(){var t=this.props.boardResource.error?3:1;z.b.endTiming({upwtStopReason:t}),this.props.traceLogger.sendEvent(new Y.d({result:t}))},t.prototype.render=function e(){var t=this,n=this.props,o=n.boardResource,r=n.onBoardCreate,a=n.pin,i=this.state.searchQuery,c=[];o.isLoaded&&!o.error&&(c=this.getItems());var l=c.filter(function(e){return e&&"allBoards"===e.category}).length;return B.a.createElement(j.b,{width:"100%",shape:"rounded",overflow:"hidden"},!o.isLoaded&&B.a.createElement(j.b,{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",minHeight:200},B.a.createElement(j.E,{accessibilityLabel:M.a._("loading board picker","accessibility text for loading spinner"),show:!0})),o.isLoaded&&B.a.createElement(j.b,{position:"relative"},B.a.createElement(j.b,{display:"flex",direction:"column",width:"100%",dangerouslySetInlineStyle:{__style:{zIndex:0}}},B.a.createElement(j.b,{display:"flex",padding:2},B.a.createElement(X.a,{accessibilityLabel:M.a._("Search through your boards","search bar placeholder text"),focused:!0,id:"pickerSearchField",onChange:function e(n){var o=n.value;return t.handleSearchQueryUpdate(o)},placeholder:M.a._("Search","search bar placeholder text"),value:i})),B.a.createElement(j.b,{maxHeight:240,overflow:"scrollY"},c.map(function(e,n){return"header"===e.type?B.a.createElement(j.b,{key:e.title,paddingX:2,paddingY:1,marginTop:n>0?2:1},B.a.createElement(j.I,{size:"sm"},e.title)):B.a.createElement(j.b,{key:e.category+"-"+e.id},B.a.createElement(D,{board:e,onClick:function e(n){t.handleBoardClick({board:n,toggleSections:!!n.section_count})}}),e.isOpen&&B.a.createElement(j.b,null,B.a.createElement(D,{board:e,onClick:function e(n){t.handleBoardClick({board:n,toggleSections:!1})},shouldOpenSections:!1}),B.a.createElement(H,{board:e,onClick:t.handleSectionClick})))}),l<=3&&B.a.createElement(Q,{pinId:a.id,onClick:r})),B.a.createElement(j.i,null),B.a.createElement(j.b,{overflow:"hidden",dangerouslySetInlineStyle:{__style:{borderBottomRightRadius:8,borderBottomLeftRadius:8}}},B.a.createElement(U,{onClick:function e(){return r({title:t.state.searchQuery})}})))))},t}(O.Component),te=Object(Z.compose)(Object(A.c)({name:"BoardPickerBoardsResource",key:"boardResource",options:function e(t){return{pin_id:t.pin.id,field_set_key:"board_picker",shortlist_suggestions:2}}},{allowStale:!1}),$.a)(ee),ne=n("GGB8"),oe=n.n(ne),re=n("695w"),ae=n("biwq"),ie=n("r/ec"),ce=n("tmfO"),le=n("8N7E"),se=n("ZtCB"),de=n.n(se),ue=n("kxCB"),pe=n("Cjb7"),he=n("suNN"),fe=n("te8a"),be=Object(A.c)({name:"BoardPickerBoardsShortlistResource",key:"suggestedBoardsResource",options:function e(t){return{pin_id:t.pinId,shortlist_length:5,num_shortlist_suggestions:5,suggestions_only:!0,min_confidence:.5}}})(y),me=n("mSxZ");n.d(t,"PinBetterSave",function(){return ge}),t.default=C;var ge=function(e){function t(){var n,o,r;S(this,t);for(var a=arguments.length,i=Array(a),c=0;c<a;c++)i[c]=arguments[c];return n=o=_(this,e.call.apply(e,[this].concat(i))),o.state={searchQuery:"",suggestedBoardTitle:"",showBoardFlyout:!1,showRepinModal:!1},o.setBoardSaveCompletionPromise=function(e){o._repinCompletionPromise=e,o._repinCompletionPromise.promise.then(function(e){if(e.board){var t=e.board,n={boardId:t.id,title:t.name,url:t.url};o.updateSelectedBoardOrSection(n),o.updateSavedState(Object.assign({},n,{localPinId:e.id}))}o.handleRepinHide()})},o.startPWTSaveRequestTiming=function(){var e=o.props.traceLogger,t=17,n=4;z.b.beginTiming({auxData:o.props.pwtAuxData,isPageLoad:!1,eventName:17,metricCause:4,samplingRate:.1}),e.sendEvent(new Y.C)},o.stopPWTSaveRequestTiming=function(e){var t=o.props.traceLogger;z.b.endTiming({upwtStopReason:e}),t.sendEvent(new Y.D({result:e}))},o.updateSavedState=function(e){var t=o.props,n=t.save,r=t.onSave,a=t.pin.id;n(Object.assign({pinId:a},e)),r&&r()},o.updateSelectedBoardOrSection=function(e){var t=o.props,n=t.selectBoardOrSection,r=t.pin.id;n(Object.assign({pinId:r},e))},o.updateSelectedItem=function(e){var t=(e||o.props).initialSelection;!o.props.selectedItem&&t&&o.updateSelectedBoardOrSection(t)},o.handleItemChosen=function(e){o.updateSelectedBoardOrSection(e),o.hideFlyout(!0),o.save(e)},o.handleBoardCreate=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).title,t=void 0===e?"":e;o.hideFlyout(!0),o.setState(function(e){return Object.assign({},e,{suggestedBoardTitle:t,showRepinModal:!0})});var n=o.props.onToggleFlyout;n&&n(!0,!0)},o.handleRepinHide=function(){o.setState(function(e){return Object.assign({},e,{suggestedBoardTitle:"",showRepinModal:!1})});var e=o.props.onToggleFlyout;e&&e(!1,!1)},o.handleBoardDropdownClick=function(e){e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),o.state.showBoardFlyout?o.hideFlyout(!0):(o.setBoardPickerPWTLoadingStart(),o.showFlyout())},o.showSuccessToast=function(){var e=o.props,t=e.showToast,n=e.hideAllToasts;t(function(e){var t=e.onHide;return O.createElement(re.a,{onHide:t,hideAllToasts:n,placementId:11})})},o.handleSaveClick=function(e){var t=o.props.selectedItem;t?(e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),o.save(t)):o.handleBoardDropdownClick(e)},o.handleEditSubmit=function(e){var t=e.boardId,n=e.sectionId,r=e.url,a=e.title,i=o.props,c=i.pin.id,l=i.savedInfo,s=(l=void 0===l?{}:l).localPinId;o.updateSavedState({pinId:c,localPinId:s,boardId:t,sectionId:n,url:r,title:a})},o.resetPinSavedState=function(){o.updateSavedState({boardId:"",localPinId:"",sectionId:"",title:"",url:""})},o.save=function(e){o.updateSavedState(e),o.startPWTSaveRequestTiming(),o.getPinResource(e).callCreate({showError:!0}).then(function(t){var n=t.resource_response.data;o.stopPWTSaveRequestTiming(1),o.updateSavedState(Object.assign({},e,{localPinId:n.id})),pe.b.publish("currentUser","pinCreated",n),pe.b.publish(n.board.id,"pinCreated",{pin:n}),pe.b.publish(n.board.id,"pinRepinned",n),o.showSuccessToast()}).catch(function(e){o.stopPWTSaveRequestTiming(3),o.resetPinSavedState()})},o.hideFlyout=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=o.props.onToggleFlyout;o.setState({showBoardFlyout:!1}),t&&t(!1,e)},r=n,_(o,r)}return I(t,e),t.prototype.UNSAFE_componentWillMount=function e(){this.updateSelectedItem()},t.prototype.UNSAFE_componentWillReceiveProps=function e(t){this.updateSelectedItem(t)},t.prototype.getPinResource=function e(t){var n=this.props,o=n.location,r=n.pin,a="RepinResource",i=Object(ae.a)(r,o)||r.tracking_params+"~0",c=Object.assign({description:r.description||"",link:r.link,title:r.title||"",clientTrackingParams:i,board_id:t.boardId||"",pin_id:r.id||"",image_base64:r.image_base64,is_buyable_pin:!1,is_removable:r.promoted_is_removable},t.sectionId?{section:t.sectionId}:{});return de.a.create(a,c)},t.prototype.setBoardPickerPWTLoadingStart=function e(){var t=16,n=4;z.b.beginTiming({auxData:{pin_create_method:"repin"},isPageLoad:!1,eventName:16,metricCause:4,samplingRate:.1}),this.props.traceLogger.sendEvent(new Y.c)},t.prototype.showFlyout=function e(){var t=this.props.onToggleFlyout;this.setState({showBoardFlyout:!0}),t&&t(!0,!0)},t.prototype.render=function e(){var t=this,n=this.props,o=n.inMasonry,r=n.inCloseup,a=n.onToggleModal,i=n.pin,c=n.selectedItem,l=n.savedInfo,s=n.unselectedText,d=this.state,u=d.showBoardFlyout,p=d.showRepinModal,h=d.suggestedBoardTitle,f=o?ie.a:j.j;return O.createElement(j.b,{width:"100%"},l&&l.title?O.createElement(j.b,{display:"flex",justifyContent:"center",direction:"row",alignItems:"center"},O.createElement(j.b,{paddingX:1,flex:"grow"},O.createElement(ce.b,{className:"underlineLink",stopPropagation:!0,style:{color:r?"#333":"#fff"},to:l.url},O.createElement(j.I,{color:r?"darkGray":"white",inline:!0},Object(he.b)(M.a._("Saved to {{ destination }}","Saved to label for better save"),{destination:O.createElement(j.I,{color:r?"darkGray":"white",bold:!0,inline:!0,key:"pin_auto_save_link"},l.title)})))),O.createElement(j.b,{paddingX:1},O.createElement(le.default,{component:0,onDelete:this.resetPinSavedState,onSubmit:this.handleEditSubmit,pinId:l.localPinId,onToggleModal:a}))):O.createElement(j.b,{alignItems:"center",display:"flex",width:"100%"},O.createElement("button",{className:oe()("PinBetterSave__Dropdown",{"PinBetterSave__Dropdown--expanded":u}),"data-test-id":"PinBetterSaveDropdown",onClick:this.handleBoardDropdownClick,ref:function e(n){return t.anchor=n}},O.createElement(j.b,{marginRight:2,minWidth:0,overflow:"hidden"},c&&c.title?O.createElement(j.I,{truncate:!0,__dangerouslyIncreaseLineHeight:!0},c.title):O.createElement(j.I,{color:"gray",__dangerouslyIncreaseLineHeight:!0,truncate:!0},s)),O.createElement(j.b,{flex:"none",marginRight:-1,"data-test-id":"boardSelectionDropdown"},O.createElement(j.m,{accessibilityLabel:M.a._("Select a board you want to save to","BetterSave accessibility label to change the board"),color:"darkGray",icon:"arrow-down",size:12}))),!u&&O.createElement("button",{className:"PinBetterSave__Button",onClick:this.handleSaveClick,"data-test-id":"PinBetterSaveButton"},O.createElement(j.I,{bold:!0,color:"white"},M.a._("Save","BetterSave Save label")))),p&&O.createElement(me.c,{isInModal:!0,onClose:this.handleRepinHide,pin:i,pwtAuxData:{pin_create_method:"repin"},setCompletionPromise:this.setBoardSaveCompletionPromise,showCreate:!0,suggestedBoardTitle:h,additionalCreateFields:{is_stl_pin:Object(fe.d)(i)}}),this.state.showBoardFlyout&&O.createElement(f,{anchor:this.anchor,idealDirection:"down",onDismiss:this.hideFlyout,positionRelativeToAnchor:!o,size:"md"},O.createElement(te,{selectedItem:c,onItemChosen:this.handleItemChosen,onBoardCreate:this.handleBoardCreate,pin:i})))},t}(O.Component),ye=function e(t,n){var o=n.pin.id,r=t.pins[o];return{savedInfo:r&&r.savedInfo,selectedItem:r&&r.selectedItem,location:t.location}},ve=function e(t){return{save:function e(n){return t(v(n))},selectBoardOrSection:function e(n){return t(E(n))}}},Ee=Object(Z.compose)(Object(T.connect)(ye,ve),$.a,ue.a)(ge)}});